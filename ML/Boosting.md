#### ะะฑัะตะต
 - ะคะะะกะะะะะะขะฌ RANDOM_STATE
 - ะะผะตัั early_stop
 - ะัะธ KFold ะพะฑััะตะฝะธะธ ััะผะผะธัะพะฒะฐัั ะธ ัััะตะดะฝััั ะฟัะตะดัะบะฐะทะฐะฝะธั ะฟะพ ัะพะปะดะฐะผ
##### KFold training code
```
def fold_train(X,
ย ย ย ย ย ย ย ยy,
ย ย ย ย ย ย ย ยmodel,
ย ย ย ย ย ย ย ยparams,
ย ย ย ย ย ย ย ยn_folds,
ย ย ย ย ย ย ย ยcat_features,
ย ย ย ย ย ย ย ย):

ย kf = KFold(n_splits= n_folds, shuffle=True, random_state=RANDOM_STATE)
ย scores=[]
ย models=[]
ย print(f"========= INITIATING {model.__name__} =========")
ย for num_fold, (train_idx,test_idx) in enumerate(kf.split(X)):
ย ย X_train,y_train = X.iloc[train_idx],y.iloc[train_idx]
ย ย X_test,y_test = ยX.iloc[test_idx],y.iloc[test_idx]
ย ย if params is not None:
ย ย ย clf = model(**params)
ย ย else:
ย ย ย clf = model()
ย ย ย 
ย ย if model.__name__ == "CatBoostRegressor":
ย ย ย train_set = Pool(data=X_train,label=y_train,cat_features=cat_features)
ย ย ย test_set = Pool(data=X_test,label=y_test,cat_features=cat_features)
ย ย ย clf.fit(train_set,
ย ย ย ย ย ย ย eval_set=test_set,
ย ย ย ย ย ย ย verbose=0)
ย ย ย ย ย ย ย 
ย ย if model.__name__ == "LGBMRegressor":
ย ยtrain_set=Dataset(X_train,y_train,categorical_feature=cat_features,free_raw_data=False)

test_set=Dataset(X_test,y_test,categorical_feature=cat_features,free_raw_data=False,reference= train_set)
ย ย ย #evals = {}
ย ย ย clf = lgb.train(
ย ย ย ย ย params,
ย ย ย ย ย train_set=train_set,
ย ย ย ย ย valid_sets=[test_set],)
ย ย ย ย ย #callbacks=[lgb.record_evaluation(evals)])
ย ย ย ย ย 
ย ย if model.__name__ == "XGBRegressor":
ย ย ย train_set = DMatrix(X_train,label=y_train,nthread=-1,enable_categorical=True)
ย ย ย test_set = DMatrix(X_test,label=y_test,nthread=-1,enable_categorical=True)
ย ย ย clf = xgb.train(params,
ย ย ย ย ย ย ย ย ย ย dtrain=train_set,
ย ย ย ย ย ย ย ย ย ย evals=[(train_set, 'dtrain'), (test_set, 'dtest')],
ย ย ย ย ย ย ย ย ย ย verbose_eval=0)
ย ย ย X_test=test_set

  
ย ย y_pred=clf.predict(X_test)
ย ย score=mean_squared_error(y_pred,y_test)
ย ย models.append(clf)
ย ย scores.append(score)

ย ย print(f'=== Fold: {num_fold} === score: {score} ===')
ย ย 
ย final_score = np.mean(scores,dtype='float16') - np.std(scores,dtype='float16')
ย print(f'Final score: {final_score}')

ย best_model = models[np.argmin(scores)]
ย return final_score,best_model
```
##### GridSearchCode
```
def tuning_hyperparams(algorithm,
ย ย ย ย ย ย ย ย ย ย ย ยX,
ย ย ย ย ย ย ย ย ย ย ย ยy,
ย ย ย ย ย ย ย ย ย ย ย ยinit_params,
ย ย ย ย ย ย ย ย ย ย ย ยgrid_params,
ย ย ย ย ย ย ย ย ย ย ย ยn_iter,
ย ย ย ย ย ย ย ย ย ย ย ยcv=3,
ย ย ย ย ย ย ย ย ย ย ย ยfit_params = None,
ย ย ย ย ย ย ย ย ย ย ย ยrandom_state=2023,
ย ย ):
ย ย estimator = algorithm(**init_params)
ย ย model = RandomizedSearchCV(estimator=estimator,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยparam_distributions=grid_params,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยn_iter=n_iter,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยcv=cv,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยscoring='neg_root_mean_squared_error',
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยn_jobs=-1,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยverbose=0,
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ย ยrandom_state=RANDOM_STATE

ย ย )
ย ย model.fit(X, y)
ย ย return model.best_params_ | init_params
```
#### CatBoost
##### Parameter notes [Pt1]
- **ะัะธะฝะธะผะฐะตั ะบะฐัะตะณะพัะธะฐะปัะฝัะต ัะธัะธ**ยััะฐะทั ะฑะตะท ะฒััะบะพะน ะฟัะตะดะฒะฐัะธัะตะปัะฝะพะน ะพะฑัะฐะฑะพัะบะธ.
- ะงัะพะฑั ะฟะตัะตะฝะตััะธ ะพะฑััะตะฝะธะต ัย**`CPU`**ยะฝะฐย**`GPU`**ยะดะพััะฐัะพัะฝะพ ะฟะพะผะตะฝััั ะทะฝะฐัะตะฝะธะต 1 ะฟะฐัะฐะผะตััะฐ, ะฑะตะท ัััะฐะฝะพะฒะบะธ ะดะพะฟ.ะฟะฐะบะตัะพะฒ ะธะปะธ ัะฟะตัะธะฐะปัะฝัั ะฒะตััะธะน, ะบะฐะบ ะฒ ะดััะณะธั ะฑะธะฑะปะธะพัะตะบะฐั
- ะะฐะถะต ั ะดะตัะพะปัะฝัะผะธ ะฟะฐัะฐะผะตััะฐะผะธ ะฒัะดะฐะตั ัะพัะพััั ัะพัะฝะพััั ะผะพะดะตะปะธ
    - ะัะฝะพะฒะฝัะต ะฟะฐัะฐะผะตััั ะฝะต ะบะพะฝััะฐะฝัะฝัะต, ะฐย**ะฟะพะดะฑะธัะฐัััั ัะฐะผะพะน ะฑะธะฑะปะธะพัะตะบะพะน**, ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะฐะทะผะตัะฐ ะฒัะพะดะฝัั ะดะฐะฝะฝัั.
- ะะพะถะตั ะฟัะธะฝะธะผะฐัั ัะตะบััะพะฒัะต ะฟัะธะทะฝะฐะบะธ, ัะผะฑะตะดะดะธะฝะณะธ, ะฒัะตะผะตะฝะฝัะต ะฟัะธะทะฝะฐะบะธ.
- ะะตะท ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะผะฐะฝะธะฟัะปััะธะน ะธ ะพะฑะตััะพะบ ะฒัััะฐะธะฒะฐะตััั ะฒ ััะฐะฝะดะฐััะฝัะต ะฟะฐะนะฟะปะฐะนะฝั (ะฝะฐะฟัะธะผะตั,ย`sklearn`).
- ะะดะตั ะฒ ะบะพะผะฟะปะตะบัะต ั "ะฑะฐัะฐัะตะนะบะฐะผะธ":ย`feature_selection`,ย`object_selection`,ย`cross_validation`,ย`grid_search`ยะธ ะฟั
- l2_leaf_reg : ัััะฐััะตั ะผะพะดะตะปั ะฟัะตะดะพัะฒัะฐัะฐั ะฟะพะดะณะพะฝะบั ะฟะพะด ััะผ ะฒ ะดะฐะฝะฝัั
- min_data_in_leaf
- max_leaves:  ะผะตะฝััะต ะปะธััะพะฒ - ัะปะพะถะฝะตะต ะผะพะดะตะปั
- subsample: ะฟะพะดะฒัะฑะพัะบะฐ ะดะปั ะบะฐะถะดะพะณะพ ะดะตัะตะฒะฐ ะฟัะธะฒะพะดะธั ะบ ัะฝะธะถะตะฝะธั ะฟะพะดะณะพะฝะบะธ ะฟะพะด ััะผ
- colsample_bylevel: ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ะปะธัั ัะฐััะธ ะฟัะธะทะฝะฐะบะพะฒ ะฟัะธ ัะฐะทะฑะธะตะฝะธะธ
- ะัะตะดะฒะฐัะธัะตะปัะฝะฐั ะบะฒะฐะฝัะธะปะธะทะฐัะธั : ัะฐะทะฑะธะตะฝะธะต ะฝะตะฟัะตััะฒะฝะพะณะพ ะฟัะธะทะฝะฐะบะฐ ะฝะฐ ะดะธัะบัะตัะฝัะต ะฑะธะฝั, ะฟะพะปะตะทะฝะฐ ะฟัะธ ัะฐะฑะพัะต ั ะดะฐะฝะฝัะผะธ ั ะฑะพะปััะธะผ ัะฐะทะฑัะพัะพะผ. ะะตัะพััะฝะฐ ะฟะพัะตัั ะธะฝัะพัะผะฐัะธะธ, ัะปะตะดัะตั ัะฒะตะปะธัะธะฒะฐัั ะบะพะป-ะฒะพ ัะฐะทะฑะธะตะฝะธะน ะดะปั ะณะพะปะด ะฟัะธะทะฝะฐะบะพะฒ
##### Parameter notes [Pt2]

**ะะฐะทะพะฒัะต ะฟะฐัะฐะผะตััั**
- `iterations`ย(ัะธะฝะพะฝะธะผัย`num_boost_round`,ย`n_estimators`,ย`num_trees`) - ะผะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ะดะตัะตะฒัะตะฒ, ะธัะฟะพะปัะทัะตะผัั ะฒ ะผะพะดะตะปะธ (ะฟะพ ัะผะพะปัะฐะฝะธัย**`1000`**).  
    ะะฝะฐัะตะฝะธะต ะผะพะถะตั ะฑััั ะฝะธะถะต ะทะฐะดะฐะฝะฝะพะณะพ, ะตัะปะธ ะธัะฟะพะปัะทััััั ะดััะณะธะต ะฟะฐัะฐะผะตััั, ะฝะฐะบะปะฐะดัะฒะฐััะธะต ะพะณัะฐะฝะธัะตะฝะธะต ะฝะฐ ะบะพะปะธัะตััะฒะพ ะดะตัะตะฒัะตะฒ;
- `learning_rate`ยะธะปะธย`eta`ยโ ัะบะพัะพััั ะพะฑััะตะฝะธั, ะบะพัะพัะฐั ะพะฟัะตะดะตะปัะตั, ะฝะฐัะบะพะปัะบะพ ะฑััััะพ ะธะปะธ ะผะตะดะปะตะฝะฝะพ ะผะพะดะตะปั ะฑัะดะตั ััะธัััั. ะะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั ะพะฑััะฝะพ ัะฐะฒะฝะพย**`0.03`**.
- `depth (max_depth)`ย- ะณะปัะฑะธะฝะฐ ะดะตัะตะฒะฐ (ะฟะพ ัะผะพะปัะฐะฝะธั 6, ะผะฐะบัะธะผะฐะปัะฝะพะต ะทะฝะฐัะตะฝะธะต - 16);
- `cat_features`ย- ัะฟะธัะพะบ ะฝะฐะธะผะตะฝะพะฒะฐะฝะธะน ะบะฐัะตะณะพัะธะฐะปัะฝัั ะฟัะธะทะฝะฐะบะพะฒ;

**ะะตะถะธะผ ะพะฑััะตะฝะธั**
- `loss_function`ยะธะปะธย`objective`- ััะฝะบัะธั ะฟะพัะตัั, ะบะพัะพััั ะฝะฐะดะพ ะผะธะฝะธะผะธะทะธัะพะฒะฐัั ะฟัะธ ะพะฑััะตะฝะธะธ. ะััั ะฟะพะบะฐะทะฐัะตะปะธ ะดะปั ัะตะณัะตััะธะธ (ััะตะดะฝะตะบะฒะฐะดัะฐัะธัะฝะฐั ะพัะธะฑะบะฐ), ะตััั ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ (`logloss`).
- `eval_metric`ย- ะฒะฐะปะธะดะฐัะธะพะฝะฝะฐั ะผะตััะธะบะฐ, ะธัะฟะพะปัะทัะตะผะฐั ะดะปั ะพะฑะฝะฐััะถะตะฝะธั ะฟะตัะตะพะฑััะตะฝะธั ะธ ัะฐะฝะฝะตะน ะพััะฐะฝะพะฒะบะธ;
- `custom_metric`ย- ะพััะปะตะถะธะฒะฐะตะผัะต ะผะตััะธะบะธ. ะัััะธะต ะผะตััะธะบะธ ะฒ ะฟัะพัะตััะต ะพะฑััะตะฝะธั ะผะพะถะฝะพ ะฒะตัะฝััั ะผะตัะพะดะพะผย`get_best_score`;
- `early_stopping_rounds`ย- ะพะฟัะตะดะตะปัะตั ัะธัะปะพ ะธัะตัะฐัะธะน ะดะพ ะพััะฐะฝะพะฒะบะธ, ะตัะปะธ ะฝะฐ ะธั ะฟัะพััะถะตะฝะธะธ ะผะตััะธะบะฐ ะบะฐัะตััะฒะฐ ะฝะต ัะปัััะฐะปะฐัั ะฟะพ ััะฐะฒะฝะตะฝะธั ั ะพะฟัะธะผะฐะปัะฝะพะน;
- `use_best_model`ย- ะตัะปะธย**`True`**, ะฒ ัะตะทัะปััะฐัะต ะพะฑััะตะฝะธั ั ัะฐะฝะฝะตะน ะพััะฐะฝะพะฒะบะพะน ะฑัะดะตั ะฒะพะทะฒัะฐัะฐัััั ะผะพะดะตะปั, ะฟะพะปััะตะฝะฝะฐั ะฝะฐ ะธัะตัะฐัะธะธ (ะบะพะปะธัะตััะฒะพะผ ะดะตัะตะฒัะตะฒ) ั ะปัััะตะน ะผะตััะธะบะพะน ะฝะฐ ะฒะฐะปะธะดะฐัะธะพะฝะฝะพะน ะฒัะฑะพัะบะต;

**ะะตะณัะปััะธะทะฐัะธั ะผะพะดะตะปะธ, ััะบะพััััะธะต ะธ ะพะฑะพะฑัะฐััะธะต ะผะพะดะตะปั**
- `l2_leaf_reg`ย(ะธะปะธย`reg_lambda`) โ ะบะพัััะธัะธะตะฝั ะฟัะธ ัะปะตะฝะต ัะตะณัะปััะธะทะฐัะธะธย**`L2`**ยััะฝะบัะธะธ ะฟะพัะตัั. ะะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั โย**`3.0`**.
- `min_data_in_leaf (min_child_samples)`ย- ะผะธะฝะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ะพะฑััะฐััะธั ััะผะฟะปะพะฒ ะฒ ะปะธััะต.
- `max_leaves (num_leaves)`ย- ะผะฐะบัะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ะปะธัััะตะฒ ะฒ ะดะตัะตะฒะต.
- `subsample`ย- ัะฐััั ะธััะพะดะฝะพะน ะฒัะฑะพัะบะธ, ะพัะฑะธัะฐะตะผะฐั ะดะปั ะพะฑััะตะฝะธั ะบะฐะถะดะพะณะพ ะดะตัะตะฒะฐ;
- `colsample_bylevel`ย- ะดะพะปั ะฟัะธะทะฝะฐะบะพะฒ, ะธัะฟะพะปัะทัะตะผะฐั ะดะปั ะพัะฑะพัะฐ ะฝะฐ ะบะฐะถะดะพะผ ัะฟะปะธัะต;
- `max_bin`ย- ะผะฐะบัะธะผะฐะปัะฝะพะต ัะธัะปะพ ะฑะธะฝะพะฒ, ะฝะฐ ะบะพัะพััะต ัะฐะทะฑะธะฒะฐัััั ะฟัะธะทะฝะฐะบะธ

**ะะพะปะตะทะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั**
- `random_seed`ยะธะปะธย`random_state`ยโ ะธะฝะธัะธะฐะปะธะทะธััััะตะต ะทะฝะฐัะตะฝะธะต ะดะปั ะธัะฟะพะปัะทัะตะผะพะณะพ ะณะตะฝะตัะฐัะพัะฐ ัะปััะฐะนะฝัั ัะธัะตะป, ััะพะฑั ะพะฑะตัะฟะตัะธัั ะฒะพัะฟัะพะธะทะฒะพะดะธะผะพััั ัะบัะฟะตัะธะผะตะฝัะฐ;
- `task_type`ย- ะธัะฟะพะปัะทัะตะผะพะต ะดะปั ะฒััะธัะปะตะฝะธะน ััััะพะนััะฒะพ (**`CPU`**,ย**`GPU`**);
- `thread_count`ย- ัะธัะปะพ ะธัะฟะพะปัะทัะตะผัั ะดะปั ะพะฑััะตะฝะธั ะฟะพัะพะบะพะฒ (ะฟะพ ัะผะพะปัะฐะฝะธั =ย**`-1`**, ััะพ ะพะทะฝะฐัะฐะตั - ะฒัะต ัะดัะฐ ะฟัะพัะตััะพัะฐ);
- `verbose`ย- ะพะฑัะตะผ ะฒัะฒะพะดะธะผะพะน ะธะฝัะพัะผะฐัะธะธ (**`False`**ย- ะฟะพะดะฐะฒะปัะตะผ ัะพะพะฑัะตะฝะธั).

**ะะฐะปะฐะฝัะธัะพะฒะบะฐ ะบะปะฐััะพะฒ**
- `class_weights`ย- ะฒะตัะฐ ะบะปะฐััะพะฒ ะฒ ะผะพะดะตะปัั ะบะปะฐััะธัะธะบะฐัะธะธ. ะัะฟะพะปัะทัะตััั ะดะปั ััััะฐะฝะตะฝะธั ะดะธัะฑะฐะปะฐะฝัะฐ (ะฝะฐะฟัะธะผะตั, ะฒะตัย`positive`=ย`ะบะพะปะธัะตััะฒะพ_negative`/`ะบะพะปะธัะตััะฒะพ_positive`);
- `classes_count`ย- ะบะพะปะธัะตััะฒะพ ะบะปะฐััะพะฒ ะดะปั ะผะฝะพะณะพะบะปะฐััะพะฒะพะน ะบะปะฐััะธัะธะบะฐัะธะธ;
- `auto_class_weights`ย- ััััะฐะฝัะตั ะดะธัะฑะฐะปะฐะฝั ะฐะฒัะพะผะฐัะธัะตัะบะธ (ะทะฝะฐัะตะฝะธั -ย**`Balanced`**,ย**`SqrtBalanced`**);
- `scale_pos_weight`ย- ะทะฐะดะฐะตั ะฒะตั ะดะปั ะฟะพะปะพะถะธัะตะปัะฝะพะณะพ ะบะปะฐััะฐ; ะกัะตะดะธ ะฟะฐัะฐะผะตััะพะฒย`scale_pos_weight`,ย`auto_class_weights`,ย`class_weights`ยะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะธัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะพะดะธะฝ.

##### Best practices ะฟะพ ะฝะฐะดัััะพะนะบะต

- ๐ ะะฐัะตะณะพัะธะฐะปัะฝัะต ะฟัะธะทะฝะฐะบะธ ะฟะพะผะตัะฐัั ะฒย`cat_features`. ะกะฐะผะธ ะฝะต ะบะพะดะธััะตะผ.
- โ๏ธ ะคะธะบัะธัะพะฒะฐััย`random_seed`ยะผะพะดะตะปะธ ะธ ัะฐะทะฑะธะตะฝะธั. (ะ ะธะดะตะฐะปะต, ะฟะพััะดะพะบ ัะธัะตะน ัะพะถะต)
- ๐ ะะพะผะตัะฐัั ะดะฐะฝะฝัะต ะฒย`Pool`ยะดะปั ััะบะพัะตะฝะธั. (ะะฒะฐะฝัะธะปะธะทะฐัะธั ะทะฐัะฐะฝะตะต)
- ๐ ะะผะตััย`eval_set`, ััะพะฑั ะฒัััะฐะฒะธััย`early_stopping_rounds`
- ๐ ะัะฟะพะปัะทะพะฒะฐัั ัะตะณัะปััะธะทะฐัะธะพะฝะฝัะต ะฟะฐัะฐะผะตััย`l2_leaf_reg`,ย`colsample_bylevel`,ย`subsample`ยะธ ะดััะณะธะต
- ๐ ะกัะฐะฒะธััย`max_depth`ยะบะฐะบ ะผะพะถะฝะพ ะผะตะฝััะต ะฟัะธ ัะพะผ ะถะต ััะพะฒะฝะต ัะพัะฝะพััะธ
- ๐ย`iterations`ยะดะพะปะถะตะฝ ะฑััั ั ะทะฐะฟะฐัะพะผ ะดะปั ััะฐะฑะฐััะฒะฐะฝะธัย`early_stopping_rounds`
- ๐ย`learning_rate`ยะฟะพะดะฑะธัะฐะตััั ะฟะพ ะผะตััะธะบะต.
- ๐ ะะตััะธะบะฐ - ัะฐ, ััะพ ะทะฐัะฒะปะตะฝะฐ ะฒ ัะตะผะฟะธะพะฝะฐัะต. (**Recall**,ย**MAE**,ย**ะะพััะตะปััะธั**ย...)
- โ๏ธ ะัะตะฝะธะฒะฐะตะผ ะผะพะดะตะปั ะฟะพย**`score = mean(metrics) - std(metrics)`**!
- ๐ ะะฝะพะณะดะฐ ะทะฐะฟะธััะฒะฐะตะผ ะทะฝะฐัะตะฝะธั ะผะตััะธะบะธ ะปะพะบะฐะปัะฝะพ ะธ ะธั ะทะฝะฐัะตะฝะธะต ะฝะฐ ะปะธะดะตัะฑะพัะดะต.

#### LightGBM
##### ะัะพะฑะตะฝะฝะพััะธ
ะะตะฐะปะธะทะฐัะธั ะฒะฒะพะดะธั ะดะฒะต ะบะปััะตะฒัะต ะธะดะตะธ:ย`GOSS`ยะธย`EFB`.  
- ะก ะฟะพะผะพัััย`GOSS`ย(ะัะฐะดะธะตะฝัะฝะฐั ะพะดะฝะพััะพัะพะฝะฝัั ะฒัะฑะพัะบะฐ) ะผั ะธัะบะปััะฐะตะผ ะทะฝะฐัะธัะตะปัะฝัั ัะฐััั ัะบะทะตะผะฟะปััะพะฒ ะดะฐะฝะฝัั ั ะฝะตะฑะพะปััะธะผะธ ะณัะฐะดะธะตะฝัะฐะผะธ ะธ ะธัะฟะพะปัะทัะตะผ ะพััะฐะฒัะธะตัั ัะบะทะตะผะฟะปััั ะดะปั ะพัะตะฝะบะธ ะฟัะธัะพััะฐ ะธะฝัะพัะผะฐัะธะธ. ะัะปะพ ะดะพะบะฐะทะฐะฝะพ, ััะพ, ะฟะพัะบะพะปัะบั ัะบะทะตะผะฟะปััั ะดะฐะฝะฝัั ั ะฑะพะปััะธะผะธ ะณัะฐะดะธะตะฝัะฐะผะธ ะธะณัะฐัั ะฑะพะปะตะต ะฒะฐะถะฝัั ัะพะปั,ย`GOSS`ยะผะพะถะตั ะฟะพะปััะธัั ะดะพะฒะพะปัะฝะพ ัะพัะฝัั ะพัะตะฝะบั ั ะณะพัะฐะทะดะพ ะผะตะฝััะธะผ ัะฐะทะผะตัะพะผ ะดะฐะฝะฝัั.
- `EFB`ยะธะปะธย`Exclusive Feature Bundling`ย(ะพะฑัะตะดะธะฝะตะฝะธะต ะฒะทะฐะธะผะพะธัะบะปััะฐััะธั ะฟัะธะทะฝะฐะบะพะฒ) โ ััะพ ะฟะพะดัะพะด ะพะฑัะตะดะธะฝะตะฝะธั ัะฐะทัะตะถะตะฝะฝัั (ะฒ ะพัะฝะพะฒะฝะพะผ ะฝัะปะตะฒัั) ะฒะทะฐะธะผะพะธัะบะปััะฐััะธั ะฟัะธะทะฝะฐะบะพะฒ, ัะฐะบะธั ะบะฐะบ ะบะฐัะตะณะพัะธะฐะปัะฝัะต ะฟะตัะตะผะตะฝะฝัะต, ะทะฐะบะพะดะธัะพะฒะฐะฝะฝัะต onehot-ะบะพะดะธัะพะฒะฐะฝะธะตะผ. ะญัะพ, ะฟะพ ัััะธ, ัะธะฟ ะฐะฒัะพะผะฐัะธัะตัะบะพะณะพ ะฟะพะดะฑะพัะฐ ะฟัะธะทะฝะฐะบะพะฒ.  ะั ะฟะฐะบะตัะธััะตะผ ะฒะทะฐะธะผะพะธัะบะปััะฐััะธะต ะฟัะธะทะฝะฐะบะธ (ัะพ ะตััั ะพะฝะธ ัะตะดะบะพ ะฟัะธะฝะธะผะฐัั ะฝะตะฝัะปะตะฒัะต ะทะฝะฐัะตะฝะธั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ), ััะพะฑั ัะผะตะฝััะธัั ะบะพะปะธัะตััะฒะพ ะฟัะธะทะฝะฐะบะพะฒ.
##### Parameter notes [Pt1]
**ะงัะพะฑั ะฟะพะฒััะธัั ัะพัะฝะพััั ะผะพะดะตะปะธ:**ย๐๐ฏ

- ะัะฟะพะปัะทะพะฒะฐัั ะฑะพะปััะพะนย`max_bin`ย(ะทะฐะผะตะดะปัะตั ะพะฑััะตะฝะธะต)
- ะฃะผะตะฝััะธััย`learning_rate`, ัะฒะตะปะธัะธะฒ ัะธัะปะพ ะดะตัะตะฒัะตะฒย`num_iterations`
- ะฃะฒะตะปะธัะธััย`num_leaves`ย(ะผะพะถะตั ะฟัะธะฒะตััะธ ะบ ะพะฒะตััะธััะธะฝะณั)
- ะะพะฟัะพะฑะพะฒะฐััย`dart`ย๐ฆ  
**ะะปั ะฑะพััะฑั ั ะฟะตัะตะพะฑััะตะฝะธะตะผ:**ย๐๐ข
- ะฃะผะตะฝััะธััย`max_bin`ยะธย`num_leaves`
- ะัะฟะพะปัะทะพะฒะฐััย`min_data_in_leaf`ยะธย`min_sum_hessian_in_leaf`
- ะัะฟะพะปัะทะพะฒะฐััย[ะฑัะณะณะธะฝะณ], ัะบะฐะทะฐะฒย`bagging_fraction`ยะธย`bagging_freq`
- ะัะฟะพะปัะทะพะฒะฐัั ัะฐะฑััะผะฟะปะธะฝะณ ะฟัะธะทะฝะฐะบะพะฒ, ัััะฐะฝะพะฒะธะฒย`feature_fraction`
- ะะพะฟัะพะฑะพะฒะฐััย`lambda_l1`,ย`lambda_l2`,ย`min_gain_to_split`ยะธย`extra_trees`ยะดะปั ัะตะณัะปััะธะทะฐัะธะธ
- ะฃััะฐะฝะพะฒะธััย`max_depth`ยะดะปั ะพะณัะฐะฝะธัะตะฝะธั ะณะปัะฑะธะฝั ะดะตัะตะฒะฐ

##### Parameter notes [Pt2]
**Dataset creation**
- ะะฐะบ ะฒ ะฑะธะฑะปะธะพัะตะบะตย`CatBoost`ยะตััั ะบะปะฐััย`Pool`ยะดะปั ัะพะทะดะฐะฝะธั ะดะฐัะฐัะตัะพะฒ, ัะฐะบ ะธ ะฒย`LightGBM`ยะตััั ะบะปะฐััย`Dataset`ยะดะปั ัะพะน ะถะต ัะตะปะธ. ะะฐะบ ะทะฐัะฒะปะตะฝะพ, ัะฒะปัะตััั ะพัะตะฝั ัััะตะบัะธะฒะฝัะผ ะฟะพ ะฟะพััะตะฑะปัะตะผะพะน ะฟะฐะผััะธ, ั.ะบ. ััะฐะฝะธั ะฝะต ะบะพะฝะบัะตัะฝัะต ะทะฝะฐัะตะฝะธั ะฟัะธะทะฝะฐะบะพะฒ, ะฐ ัะพะปัะบะพ ะธั ะดะธัะบัะตัะฝัะต ะฑะธะฝั.
- ะงะธัะปะพ ะฑะธะฝะพะฒ, ะฒ ัะฒะพั ะพัะตัะตะดั, ะผะพะถะฝะพ ะพััะตะณัะปะธัะพะฒะฐัั ะฟัะธ ัะพะทะดะฐะฝะธะธ ะดะฐัะฐัะตัะฐ, ัะผะตะฝััะธะฒ ะฟะฐัะฐะผะตัััย`max_bin`ยะธะปะธย`max_bin_by_feature`.
- ะ ะดะพะบัะผะตะฝัะฐัะธะธ ะทะฐัะฒะปะตะฝะพ, ััะพ ะผะพะถะฝะพ ะฟะพะดะฐะฒะฐัั ะบะฐัะตะณะพัะธะฐะปัะฝัะต ัะธัะธ ะฑะตะท one-hot ัะฝะบะพะดะธะฝะณะฐ. ะคัะตะนะผะฒะพัะบ ัะฐะผ ะพะฑัะฐะฑะพัะฐะตั, ััะพ ะฒัะนะดะตั ะฑััััะตะต ะดะพ 8 ัะฐะท.
- โ๏ธ ะะดะฝะฐะบะพ, ัะตะฐะปะธะทะพะฒะฐะฝะพ ััะพ ัะฟะตัะธัะธัะตัะบะธะผ ะพะฑัะฐะทะพะผ: ะฟะตัะตะด ัะพะทะฐะฝะธะตะผ ะบะปะฐััะฐย`Dataset`ยะบะฐัะตะณะพัะธะฐะปัะฝัะต ัะธัะธ ะฝะฐะดะพ ะฟัะธะฒะตััะธ ะบ ัะตะปะพัะธัะปะตะฝะฝะพะผั ัะธะฟั (`int`).
- โ๏ธ ะฆะตะปะตะฒะฐั ะฟะตัะตะผะตะฝะฝะฐั - (ะฟะฐัะฐะผะตััย`label`) ัะฐะบะถะต ะพะณัะฐะฝะธัะตะฝ ะฟะพ ะฒะพะทะผะพะถะฝัะผ ัะธะฟะฐะผ:ย`int`,ย`float`ยะธะปะธย`bool`
- `categorical_feature`
- `feature_name`ยโ ะฟัะธะฝะธะผะฐะตั ัะฟะธัะพะบ ัััะพะบ, ะพะฟัะตะดะตะปัััะธั ะธะผะตะฝะฐ ััะพะปะฑัะพะฒ.
- `reference`ยโ (`Dataset`ยะธะปะธย`None`ยะฝะฐ ะฒัะฑะพั (`default=None`)) โ ะัะปะธ ััะพย`Dataset`ยะดะปั ะฒะฐะปะธะดะฐัะธะธ, ัะพ ััะตะฝะธัะพะฒะพัะฝัะนย`Dataset`ยะดะพะปะถะตะฝ ะฑััั ัะบะฐะทะฐะฝ ะบะฐะบ ัะตัะตัะตะฝัะฝัะน.
- `group`ยโ ะธัะฟะพะปัะทัะตััั ะฟัะธ ัะตัะตะฝะธะธ ะทะฐะดะฐัะธ ัะฐะฝะถะธัะพะฒะฐะฝะธั (ะพะฑััะตะฝะธะธ ะะฐะฝะบะตัะฐ).
- `weight`ยโ ะผะพะถะฝะพ ัะบะฐะทะฐัั ัะฟะธัะพะบ ะฒะตัะพะฒ ะดะปั ะบะฐะถะดะพะณะพ ัะบะทะตะผะฟะปััะฐ ะดะฐะฝะฝัั (ะฝะตะพััะธัะฐัะตะปัะฝัะต ัะธัะปะฐ) ะธะปะธ ัััะฐะฝะพะฒะธัั ะฟะพะทะถะต, ะธัะฟะพะปัะทัั ะผะตัะพะดย`set_weight()`.
- `params`ยโ ะฟัะธะฝะธะผะฐะตั ัะปะพะฒะฐัั ะฟะฐัะฐะผะตััะพะฒ, ะทะดะตัั, ะบะฐะบ ัะฐะท, ะผะพะถะฝะพ ัะบะฐะทะฐัั ะบะพะปะธัะตััะฒะพ ะฑะธะฝะพะฒ (`max_bin`ยะธะปะธย`max_bin_by_feature`).
- `free_raw_data`ย(`bool`, optional (`default=True`)) โ ะพัะฒะตัะฐะตั ะทะฐ ะพัะฒะพะฑะพะถะดะตะฝะธะต ะฟะฐะผััะธ ะพั ััััั ะดะฐะฝะฝัั ะฟะพัะปะต ัะพะทะดะฐะฝะธั ะดะฐัะฐัะตัะฐ.
**ะะฐัะฐะผะตััั ะพะฑััะตะฝะธั**
- `params`ย
- `train_set`ยโ ะฟัะธะฝะธะผะฐะตั ะพะฑัะตะบั ัะธะฟะฐย`Dataset`, ะบะพัะพััะน ัะพะดะตัะถะธั ะธะฝัะพัะผะฐัะธั ะพ ะฟัะธะทะฝะฐะบะฐั ะธ ัะตะปะตะฒัั ะทะฝะฐัะตะฝะธัั.
- `num_boost_round`ยโ ัะบะฐะทัะฒะฐะตั ะบะพะปะธัะตััะฒะพ ะดะตัะตะฒัะตะฒ ะฑัััะธะฝะณะฐ, ะบะพัะพััะต ะฑัะดัั ะธัะฟะพะปัะทะพะฒะฐัััั ะฒ ะฐะฝัะฐะผะฑะปะต (ะฟะพ ัะผะพะปัะฐะฝะธั 100).
- `valid_sets`ยโ ะฟัะธะฝะธะผะฐะตั ัะฟะธัะพะบย`Dataset`ยะพะฑัะตะบัะพะฒ, ะบะพัะพััะต ัะฒะปััััั ะฒัะฑะพัะบะฐะผะธ ะดะปั ะฒะฐะปะธะดะฐัะธะธ. ะญัะธ ะฟัะพะฒะตัะพัะฝัะต ะดะฐัะฐัะตัั ะพัะตะฝะธะฒะฐัััั ะฟะพัะปะต ะบะฐะถะดะพะณะพ ัะธะบะปะฐ ะพะฑััะตะฝะธั.
- `valid_names`ยโ ะฟัะธะฝะธะผะฐะตั ัะฟะธัะพะบ ัััะพะบ ัะพะน ะถะต ะดะปะธะฝั, ััะพ ะธ ัย`valid_sets`, ะพะฟัะตะดะตะปัััะธั ะธะผะตะฝะฐ ะดะปั ะบะฐะถะดะพะน ะฟัะพะฒะตัะพัะฝะพะน ะฒัะฑะพัะบะธ. 
- `categorical_feature`ย
- `verbose_eval`ย
- ะขะธะฟ ะฑัััะธะฝะณะฐ ัะบะฐะทัะฒะฐะตััั ั ะฟะพะผะพััั ะฐัะณัะผะตะฝัะฐย`boosting_type`.
- `objective`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟะพะทะฒะพะปัะตั ะฝะฐะผ ะพะฟัะตะดะตะปะธัั ัะตะปะตะฒัั ััะฝะบัะธั
- `metric`
- `num_iterations`ย
- `learning_rate`ย  
- `num_leaves`ย
- `max_depth`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟะพะทะฒะพะปัะตั ะฝะฐะผ ัะบะฐะทะฐัั ะผะฐะบัะธะผะฐะปัะฝัั ะณะปัะฑะธะฝั, ัะฐะทัะตัะตะฝะฝัั ะดะปั ะดะตัะตะฒัะตะฒ ะฒ ะฐะฝัะฐะผะฑะปะต. ะะพ ัะผะพะปัะฐะฝะธั -1, ััะพ ะฟะพะทะฒะพะปัะตั ะดะตัะตะฒััะผ ัะฐััะธ, ะบะฐะบ ะผะพะถะฝะพ ะณะปัะฑะถะต.
- `min_data_in_leaf`ยโ ะดะฐะฝะฝัะน ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ัะตะปะพัะธัะปะตะฝะฝะพะต ะทะฝะฐัะตะฝะธะต, ะพะฟัะตะดะตะปัััะตะต ะผะธะฝะธะผะฐะปัะฝะพะต ะบะพะปะธัะตััะฒะพ ัะพัะตะบ ะดะฐะฝะฝัั (ัะตะผะฟะปะพะฒ), ะบะพัะพััะต ะผะพะณัั ััะฐะฝะธัััั ะฒ ะพะดะฝะพะผ ะปะธััะต ะดะตัะตะฒะฐ. ะญัะพั ะฟะฐัะฐะผะตัั ะผะพะถะฝะพ ะธัะฟะพะปัะทะพะฒะฐัั ะดะปั ะบะพะฝััะพะปั ะฟะตัะตะพะฑััะตะฝะธั. ะะฝะฐัะตะฝะธะต ะฟะพ ัะผะพะปัะฐะฝะธั 20.  
- `bagging_fraction`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ะทะฝะฐัะตะฝะธะต ั ะฟะปะฐะฒะฐััะตะน ะทะฐะฟััะพะน ะพั 0 ะดะพ 1, ะบะพัะพัะพะต ะฟะพะทะฒะพะปัะตั ัะบะฐะทะฐัั, ะฝะฐัะบะพะปัะบะพ ะฑะพะปััะฐั ัะฐััั ะดะฐะฝะฝัั ะฑัะดะตั ัะปััะฐะนะฝะพ ะพัะฑะธัะฐัััั ะฟัะธ ะพะฑััะตะฝะธะธ. ะญัะพั ะฟะฐัะฐะผะตัั ะผะพะถะตั ะฟะพะผะพัั ะฟัะตะดะพัะฒัะฐัะธัั ะฟะตัะตะพะฑััะตะฝะธะต. ะะพ ัะผะพะปัะฐะฝะธั 1.0.  
- `feature_fraction`ยโ ะดะฐะฝะฝัะน ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ะทะฝะฐัะตะฝะธะต ั ะฟะปะฐะฒะฐััะตะน ะทะฐะฟััะพะน ะพั 0 ะดะพ 1, ะบะพัะพัะพะต ะธะฝัะพัะผะธััะตั ะฐะปะณะพัะธัะผ ะพ ะฒัะฑะพัะต ััะพะน ะดะพะปะธ ะฟะพะบะฐะทะฐัะตะปะตะน ะธะท ะพะฑัะตะณะพ ัะธัะปะฐ ะดะปั ะพะฑััะตะฝะธั ะฝะฐ ะบะฐะถะดะพะน ะธัะตัะฐัะธะธ. ะะพ ัะผะพะปัะฐะฝะธั 1.0, ะฟะพััะพะผั ะธัะฟะพะปัะทััััั ะฒัะต ะฟะพะบะฐะทะฐัะตะปะธ.
- `extra_trees`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ะปะพะณะธัะตัะบะธะต ะทะฝะฐัะตะฝะธั, ะพะฟัะตะดะตะปัััะธะต, ัะปะตะดัะตั ะปะธ ะธัะฟะพะปัะทะพะฒะฐัั ััะตะทะฒััะฐะนะฝะพ ัะฐะฝะดะพะผะธะทะธัะพะฒะฐะฝะฝะพะต ะดะตัะตะฒะพ ะธะปะธ ะฝะตั.
- `force_col_wise`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ะปะพะณะธัะตัะบะพะต ะทะฝะฐัะตะฝะธะต, ะพะฟัะตะดะตะปัััะตะต, ัะปะตะดัะตั ะปะธ ะฟัะธะฝัะดะธัะตะปัะฝะพ ัััะพะธัั ะณะธััะพะณัะฐะผะผั ะฟะพ ััะพะปะฑัะฐะผ ะฟัะธ ะพะฑััะตะฝะธะธ. ะัะปะธ ะฒ ะดะฐะฝะฝัั ัะปะธัะบะพะผ ะผะฝะพะณะพ ััะพะปะฑัะพะฒ, ัััะฐะฝะพะฒะบะฐ ะดะปั ััะพะณะพ ะฟะฐัะฐะผะตััะฐ ะทะฝะฐัะตะฝะธัย`True`ยะฟะพะฒััะธั ัะบะพัะพััั ะฟัะพัะตััะฐ ะพะฑััะตะฝะธั ะทะฐ ััะตั ัะผะตะฝััะตะฝะธั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฟะฐะผััะธ.  
- `force_row_wise`ยโ ััะพั ะฟะฐัะฐะผะตัั ะฟัะธะฝะธะผะฐะตั ะปะพะณะธัะตัะบะพะต ะทะฝะฐัะตะฝะธะต, ะพะฟัะตะดะตะปัััะตะต, ัะปะตะดัะตั ะปะธ ะฟัะธะฝัะดะธัะตะปัะฝะพ ัััะพะธัั ะณะธััะพะณัะฐะผะผั ะฟะพ ัััะพะบะฐะผ ะฟัะธ ะพะฑััะตะฝะธะธ. ะัะปะธ ะฒ ะดะฐะฝะฝัั ัะปะธัะบะพะผ ะผะฝะพะณะพ ัััะพะบ, ัััะฐะฝะพะฒะบะฐ ะดะปั ััะพะณะพ ะฟะฐัะฐะผะตััะฐ ะทะฝะฐัะตะฝะธัย`True`ยะฟะพะฒััะธั ัะบะพัะพััั ะฟัะพัะตััะฐ ะพะฑััะตะฝะธั ะทะฐ ััะตั ัะผะตะฝััะตะฝะธั ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฟะฐะผััะธ. 
- `early_stopping_round`ยโ ะฟัะธะฝะธะผะฐะตั ัะตะปะพะต ัะธัะปะพ, ัะบะฐะทัะฒะฐััะตะต, ััะพ ะผั ะดะพะปะถะฝั ะพััะฐะฝะพะฒะธัั ะพะฑััะตะฝะธะต, ะตัะปะธ ะพัะตะฝะพัะฝะฐั ะผะตััะธะบะฐ, ัะฐัััะธัะฐะฝะฝะฐั ะฝะฐ ะฟะพัะปะตะดะฝะตะผ ะฟัะพะฒะตัะพัะฝะพะผ ะดะฐัะฐัะตัะต, ะฝะต ัะปัััะฐะตััั ะฝะฐ ะฟัะพััะถะตะฝะธะธ ะพะฟัะตะดะตะปะตะฝะฝะพะณะพ ะฟะฐัะฐะผะตััะพะผ ัะธัะปะฐ ะธัะตัะฐัะธะน.
- `num_class`ยโ ะตัะปะธ ะผั ัะฐะฑะพัะฐะตะผ ั ะทะฐะดะฐัะตะน ะผัะปััะธะบะปะฐััะพะฒะพะน ะบะปะฐััะธัะธะบะฐัะธะธ, ัะพ ััะพั ะฟะฐัะฐะผะตัั ะดะพะปะถะตะฝ ัะพะดะตัะถะฐัั ะบะพะปะธัะตััะฒะพ ะบะปะฐััะพะฒ.  
- `is_unbalance`ยโ ััะพ ะปะพะณะธัะตัะบะธะน ะฟะฐัะฐะผะตัั, ะบะพัะพััะน ะดะพะปะถะตะฝ ะธะผะตัั ะทะฝะฐัะตะฝะธะตย`True`, ะตัะปะธ ะดะฐะฝะฝัะต ะฝะต ัะฑะฐะปะฐะฝัะธัะพะฒะฐะฝั. ะะณะพ ัะปะตะดัะตั ะธัะฟะพะปัะทะพะฒะฐัั ั ะทะฐะดะฐัะฐะผะธ ะฑะธะฝะฐัะฝะพะน ะธ ะผัะปััะธะบะปะฐััะพะฒะพะน ะบะปะฐััะธัะธะบะฐัะธะธ.
##### Plotting importance
- plot_importance
- plot_split_value_histogram



#### XGBoost
##### ะะตะบะพัะพััะต ัะธัะบะธ
- ะะฝะพะณะพ ะฟะฐัะฐะผะตััะพะฒ ัะตะณัะปััะธะทะฐัะธะธ (`lambda`/`gamma`/`alpha`)
- ะกัะธัะฐะตััั ัะฐะผัะผ ะฑัััััะผ ะธ ะผะตะฝะตะต ัะตััััะพะทะฐััะฐัะฝัะผ ะฟะพ ััะฐะฒะฝะตะฝะธั ั ะดััะณะธะผะธ ะฑัััะธะฝะณะฐะผะธ (ัะพะปะธะฒะฐัะฝะพะต ััะฒะตัะถะดะตะฝะธะต)
- ะัััะพะตะฝะฝะฐั ัะฐะฑะพัะฐ ั ะฟัะพะฟััะบะฐะผะธ ะธ ะบะฐัะตะณะพัะธะฐะปัะฝัะผะธ ะฟัะธะทะฝะฐะบะฐะผะธ (ะฟัะพััะพย`one-hot encoding`ย) (`enable_categorical = True`ย/ย`df[cat_col].astype('category')`)
- ะะพะดะดะตัะถะบะฐ ะผะตััะธะบ ะธะท ะฑะธะฑะปะธะพัะตะบะธย**scikit-learn**ยะฒ ะบะฐัะตััะฒะต ะบะฐััะพะผะฝัั ะธะท ะบะพัะพะฑะบะธ.

- ะะพะดะดะตัะถะบะฐ ัะฐะฑะพัั ัย`Dask`ยะธย`Spark`ยะธะท ะบะพัะพะฑะบะธ.
- ะะพะดะดะตัะถะธะฒะฐะตั ัะฐะฑะพัั ั ะฟะพะฟัะปััะฝัะผะธ ะพะฑะปะฐัะฝัะผะธ ัะตัะฒะธัะฐะผะธ ะธ ัะฐัะฟัะตะดะตะปะตะฝะฝะพะต ะพะฑััะตะฝะธะต ะฝะฐ ะบะปะฐััะตัะต ะธะปะธ ะฝะตัะบะพะปัะบะธั ะผะฐัะธะฝะฐั.
- ะะพะดะดะตัะถะธะฒะฐะตั ะฑะพะปััะธะฝััะฒะพ ะฟะพะฟัะปััะฝัั ัะทัะบะพะฒ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั
- ะะพะดะดะตัะถะธะฒะฐะตััั ะดััะณะธะผะธ ััะตะนะผะฒะพัะบะฐะผะธ ะธ ัะตัะฒะธัะฐะผะธ (**Optuna**,ย**Weights & Biases**ยะธ ะฟั.)

##### ะัะพะฑะตะฝะฝะพััะธ ัะตะฐะปะธะทะฐัะธะธ ะฑัััะธะฝะณะฐ
- **ะะฐัะฐะปะปะตะปะธะทะฐัะธั:**ยะย`XGBoost`ยะฟะพัััะพะตะฝะธะต ะดะตัะตะฒัะตะฒ ะพัะฝะพะฒะฐะฝะพ ะฝะฐ ะฟะฐัะฐะปะปะตะปะธะทะฐัะธะธ. ะญัะพ ะฒะพะทะผะพะถะฝะพ ะฑะปะฐะณะพะดะฐัั ะฒะทะฐะธะผะพะทะฐะผะตะฝัะตะผะพะน ะฟัะธัะพะดะต ัะธะบะปะพะฒ, ะธัะฟะพะปัะทัะตะผัั ะดะปั ะฟะพัััะพะตะฝะธั ะฑะฐะทั ะดะปั ะพะฑััะตะฝะธั: ะฒะฝะตัะฝะธะน ัะธะบะป ะฟะตัะตัะธัะปัะตั ะปะธัััั ะดะตัะตะฒัะตะฒ, ะฒะฝัััะตะฝะฝะธะน ัะธะบะป ะฒััะธัะปัะตั ะฟัะธะทะฝะฐะบะธ. ะะฐัะพะถะดะตะฝะธะต ัะธะบะปะฐ ะฒะฝัััะธ ะดััะณะพะณะพ ะผะตัะฐะตั ะฟะฐัะฐะปะปะตะปะธะทะธัะพะฒะฐัั ะฐะปะณะพัะธัะผ, ัะฐะบ ะบะฐะบ ะฒะฝะตัะฝะธะน ัะธะบะป ะฝะต ะผะพะถะตั ะฝะฐัะฐัั ัะฒะพั ะฒัะฟะพะปะฝะตะฝะธะต, ะตัะปะธ ะฒะฝัััะตะฝะฝะธะน ะตัั ะฝะต ะทะฐะบะพะฝัะธะป ัะฒะพั ัะฐะฑะพัั. ะะพััะพะผั, ะดะปั ัะปัััะตะฝะธั ะฒัะตะผะตะฝะธ ัะฐะฑะพัั, ะฟะพััะดะพะบ ัะธะบะปะพะฒ ะผะตะฝัะตััั: ะธะฝะธัะธะฐะปะธะทะฐัะธั ะฟัะพัะพะดะธั ะฟัะธ ััะธััะฒะฐะฝะธะธ ะดะฐะฝะฝัั, ะทะฐัะตะผ ะฒัะฟะพะปะฝัะตััั ัะพััะธัะพะฒะบะฐ, ะธัะฟะพะปัะทัััะฐั ะฟะฐัะฐะปะปะตะปัะฝัะต ะฟะพัะพะบะธ. ะญัะฐ ะทะฐะผะตะฝะฐ ัะปัััะฐะตั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั ะฐะปะณะพัะธัะผะฐ, ัะฐัะฟัะตะดะตะปัั ะฒััะธัะปะตะฝะธั ะฟะพ ะฟะพัะพะบะฐะผ.
- **ะััะตัะตะฝะธะต ะฒะตัะฒะตะน ะดะตัะตะฒะฐ**ย(`gamma`): ะ ััะตะนะผะฒะพัะบะตย`GBM`ยะบัะธัะตัะธะน ะพััะฐะฝะพะฒะบะธ ะดะปั ัะฐะทะฑะธะตะฝะธั ะดะตัะตะฒะฐ ะทะฐะฒะธัะธั ะพั ะบัะธัะตัะธั ะพััะธัะฐัะตะปัะฝะพะน ะฟะพัะตัะธ ะฒ ัะพัะบะต ัะฐะทะฑะธะตะฝะธั.ย`XGBoost`ยะธัะฟะพะปัะทัะตั ะฟะฐัะฐะผะตัั ะผะฐะบัะธะผะฐะปัะฝะพะน ะณะปัะฑะธะฝัย`max_depth`ยะฒะผะตััะพ ััะพะณะพ ะบัะธัะตัะธั ะธ ะฝะฐัะธะฝะฐะตั ะพะฑัะฐัะฝะพะต ะพััะตัะตะฝะธะต. ะญัะพั โะณะปัะฑะธะฝะฝัะนโ ะฟะพะดัะพะด ะทะฝะฐัะธัะตะปัะฝะพ ัะปัััะฐะตั ะฒััะธัะปะธัะตะปัะฝัั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััั.
- **ะะฟะฟะฐัะฐัะฝะฐั ะพะฟัะธะผะธะทะฐัะธั:**ยะะปะณะพัะธัะผ ะฑัะป ัะฐะทัะฐะฑะพัะฐะฝ ัะฐะบะธะผ ะพะฑัะฐะทะพะผ, ััะพะฑั ะพะฝ ะพะฟัะธะผะฐะปัะฝะพ ะธัะฟะพะปัะทะพะฒะฐะป ะฐะฟะฟะฐัะฐัะฝัะต ัะตััััั. ะญัะพ ะดะพััะธะณะฐะตััั ะฟัััะผ ัะพะทะดะฐะฝะธั ะฒะฝัััะตะฝะฝะธั ะฑััะตัะพะฒ ะฒ ะบะฐะถะดะพะผ ะฟะพัะพะบะต ะดะปั ััะฐะฝะตะฝะธั ััะฐัะธััะธะบะธ ะณัะฐะดะธะตะฝัะฐ.
- **ะะตะณัะปััะธะทะฐัะธั:**ยะะฝ ัััะฐััะตั ัะปะพะถะฝัะต ะผะพะดะตะปะธ, ะธัะฟะพะปัะทัั ะบะฐะบ ัะตะณัะปััะธะทะฐัะธัย`LASSO`ย(L1), ัะฐะบ ะธย`Ridge`-ัะตะณัะปััะธะทะฐัะธั (L2), ะดะปั ัะพะณะพ, ััะพะฑั ะธะทะฑะตะถะฐัั ะฟะตัะตะพะฑััะตะฝะธั.
- **ะะฐะฑะพัะฐ ั ะฟัะพะฟััะบะฐะผะธ:**ยะะปะณะพัะธัะผ ัะฟัะพัะฐะตั ัะฐะฑะพัั ั ัะฐะทัะตะถะตะฝะฝัะผะธ ะดะฐะฝะฝัะผะธ, ะฒ ะฟัะพัะตััะต ะพะฑััะตะฝะธั ะทะฐะฟะพะปะฝัั ะฟัะพะฟััะตะฝะฝัะต ะทะฝะฐัะตะฝะธั ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะทะฝะฐัะตะฝะธั ะฟะพัะตัั.
- **ะัะพัั-ะฒะฐะปะธะดะฐัะธั:**ยะะปะณะพัะธัะผ ะธัะฟะพะปัะทัะตั ัะฒะพะน ัะพะฑััะฒะตะฝะฝัะน ะผะตัะพะด ะบัะพัั-ะฒะฐะปะธะดะฐัะธะธ ะฝะฐ ะบะฐะถะดะพะน ะธัะตัะฐัะธะธ.

##### Parameter notes [Pt1]
- booster: gbtree, dart,gblinear
- tree_method: 'hist' or 'gpu_hist' ; 'auto' ; 'exact' for small datasets ; 'approx' for quantiles and gradient histogram for big datasets
- lambda, alpha : L1 and L2 regularization coeffs
- gamma : min loss threshold for branch split

**ะขัะฝะธะฝะณ**
- ะะตัะฒัะน - ััะพ ะบะพะฝััะพะปั ัะปะพะถะฝะพััะธ ะผะพะดะตะปะธ, ั ะฟะพะผะพััั ะฟะฐัะฐะผะตััะพะฒ:
    - `max_depth`ย- ัะผะตะฝััะธัั
    - `min_child_weight`ย- ัะฒะตะปะธัะธัั
    - `gamma`ยะธย`lambda`ย- ัะฒะตะปะธัะธัั
- ะัะพัะพะน - ััะพ ะดะพะฑะฐะฒะธัั ัะปััะฐะนะฝะพััั ะฒ ะผะพะดะตะปั, ััะพะฑั ัะดะตะปะฐัั ะตั ัััะพะนัะธะฒะพะน ะบ ััะผั:
    - `subsample`ย- ัะผะตะฝััะธัั
    - `colsample_bytree`,ย`colsample_bylevel`,ย`colsample_bynode`ย- ัะผะตะฝััะธัั
    - ะธัะฟะพะปัะทะพะฒะฐัั ะฑัััะตัย`DART`

`dart`ย- ะะตะถะธะผ, ะฒ ะบะพัะพัะพะผ ะตัััย`dropout`, ะฐะฝะฐะปะพะณะธัะฝะพ ะบะฐะบ ะฒ ะฝะตะนัะพะฝะฝัั ัะตััั.
- `rate_drop`ย(default=0.0) -ย`Dropout rate`ย(ะดะพะปั ะฟัะตะดัะดััะธั ะดะตัะตะฒัะตะฒ, ะบะพัะพััะต ะฑัะดัั ะพัะฑัะพัะตะฝั ะฒะพ ะฒัะตะผัย`dropout`)
- `one_drop`ย(default=0) (0 ะธะปะธ 1) - ะบะพะณะดะฐ 1, ัะพัั ะฑั 1 ะดะตัะตะฒะพ ะฒัะตะณะดะฐ ะฑัะดะตั ะพัะฑัะพัะตะฝะพ ะฟัะธย`dropout`
- `skip_drop`ย(default=0.0) - ะฒะตัะพััะฝะพััั, ััะพย`dropout`ยะฝะต ะฑัะดะตั ะฒ ัะตัะตะฝะธะต ะธัะตัะฐัะธะธ ะฑัััะธะฝะณะฐ (ะธะผะตะตั ะฑะพะปััะธะน ะฟัะธะพัะธัะตั, ัะตะผ 2 ะฟัะตะดัะดััะธั ะฟะฐัะฐะผะตััะฐ)  
    **โ๏ธ ะัะปะธ ะฝะธ ะพะดะธะฝ ะธะท ััะธั ะฟะฐัะฐะผะตััะพะฒ ะฝะต ัะบะฐะทะฐัั (ะพััะฐะฒะธัั ะดะตัะพะปัะฝัะต ะทะฝะฐัะตะฝะธั), ัะพ ะฑัััะตั ะฑัะดะตั ัะฐะฑะพัะฐัั ะฒ ัะตะถะธะผะต**ย`gbtree`

###### โ๏ธย**ะะฐะถะฝะพะต ะทะฐะผะตัะฐะฝะธะต:**ย
ะัะฟะพะปัะทะพะฒะฐะฝะธะตย`predict()`ยcย`DART`ยะฑัััะตัะพะผ.  
ะัะปะธ ะพะฑัะตะบั ะฑัััะตัะฐ ะพัะฝะพัะธััั ะบ ัะธะฟัย`DART`, ััะฝะบัะธัย`predict()`ยะฒัะฟะพะปะฝะธั ะพััะตะฒ (`dropout`), ั.ะต. ะฑัะดัั ะธัะฟะพะปัะทะพะฒะฐะฝั ัะพะปัะบะพ ะฝะตะบะพัะพััะต ะดะตัะตะฒัั. ะญัะพ ะฟัะธะฒะตะดะตั ะบ ะฝะตะฟัะฐะฒะธะปัะฝัะผ ัะตะทัะปััะฐัะฐะผ, ะตัะปะธ ะดะฐะฝะฝัะต ะฝะต ัะฒะปััััั ะพะฑััะฐััะตะน ะฒัะฑะพัะบะพะน. ะงัะพะฑั ะฟะพะปััะธัั ะฟัะฐะฒะธะปัะฝัะต ัะตะทัะปััะฐัั ะฝะฐ ัะตััะพะฒะพะน ะฒัะฑะพัะบะต, ัััะฐะฝะพะฒะธัะตย`iteration_range`ยะฒ ะฝะตะฝัะปะตะฒะพะต ะทะฝะฐัะตะฝะธะต  

**ะะฐะฟัะธะผะตั:**ย`preds = bst.predict(dtest, iteration_range=(0, num_round))`

๐ย**ะะฝัะตัะตัะฝัะน ัะฐะบั:**ยะ ะฑะธะฑะปะธะพัะตะบะตย`LightGBM`ยะตััั ะฟะฐัะฐะผะตััย`xgboost_dart_mode`ย(True ะธะปะธ False), ะฒะธะดะธะผะพ ั ะฝะธั ัะฐะทะปะธัะฝัะต ัะตะฐะปะธะทะฐัะธะธย`DART`.

##### Parameter notes [Pt2]
**DMatrix parameters**
- `data`ย- ะดะฐะฝะฝัะต ะดะปั ะพะฑััะตะฝะธั
- `label`ย- ัะฐัะณะตั
- `nthread`ย- ะบะพะปะธัะตััะฒะพ ะฟะฐัะฐะปะปะตะปัะฝัั ะฟะพัะพะบะพะฒ ะฟัะธ ะทะฐะณััะทะบะต ะดะฐะฝะฝัั (`-1`ยะพะทะฝะฐัะฐะตั ะฒัะต ะฟะพัะพะบะธ)
- `missing`ย(ะฟะพ ัะผะพะปัะฐะฝะธัย`np.nan`) - ะผะพะถะฝะพ ัะบะฐะทะฐัั ะทะฝะฐัะตะฝะธะต, ะบะพัะพััะผ ะทะฐะผะตะฝะธัั ะฟัะพะฟััะบะธ.
- `enable_categorical`ย- ัะฐะผ ะพะฟัะตะดะตะปะธั ะบะฐัะตะณะพัะธะฐะปัะฝัะต ัะธัะธ, ะตัะปะธ ะพะฝะธ ะฑัะปะธ ะฟัะตะดะฒะฐัะธัะตะปัะฝะพ ะฟะตัะตะฒะตะดะตะฝั ะฒ ัะธะฟย`category`ยะดะปัย`pandas.DataFrame`.*  
- ะะฐะบ ะธ ะฒย`LightGBM`, ะบะฐั. ัะธัะธ ะธะท ัััะพะบ ะฝะฐะดะพ ะฟัะตะดะฒะฐัะธัะตะปัะฝะพ ะฟะตัะตะฒะตััะธ ะบ ัะตะปะพัะธัะปะตะฝะฝะพะผั ัะธะฟั, ั.ะต. ะฟัะพะฒะตััะธย`label-encoding`.
**Important hyperparameters**
- `booster`
- `tree_method`
- `eta`ย(default=0.3, aka:ย`learning_rate`) - ัะฐะณ ะพะฑััะตะฝะธั
- `max_depth`ย(default=6) - ะผะฐะบัะธะผะฐะปัะฝะฐั ะณะปัะฑะธะฝะฐ ะดะตัะตะฒะฐ. ะงะตะผ ะฑะพะปััะต ะณะปัะฑะธะฝะฐ, ัะตะผ ัะปะพะถะฝะตะต ะผะพะดะตะปั ะธ ะฑะพะปะตะต ัะบะปะพะฝะฝะฐ ะบ ะพะฒะตััะธัั.
- `num_boosting_rounds`ย(default=100, ะฒ sklearn APIย`n_estimators`) - ะบะพะปะธัะตััะฒะพ ะดะตัะตะฒัะตะฒ(ะธัะตัะฐัะธะน) ะฑัััะธะฝะณะฐ.
- `lambda`ย(default=1, alias:ย`reg_lambda`) ะธย`alpha`ย(default=0, alias:ย`reg_alpha`) - ะพัะฒะตัะฐัั ะทะฐ L2 ะธ L1 ัะตะณัะปััะธะทะฐัะธะธ ัะพะพัะฒะตัััะฒะตะฝะฝะพ. ะงะตะผ ะฑะพะปััะต ะทะฝะฐัะตะฝะธะต ะฟะฐัะฐะผะตััะพะฒ, ัะตะผ ะฑะพะปะตะต ะบะพะฝัะตัะฒะฐัะธะฒะฝะพะน (ะผะตะฝะตะต ัะบะปะพะฝะฝะพะน ะบ ะฟะตัะตะพะฑััะตะฝะธั, ะฝะพ ะผะพะถะตั ัะฟััะบะฐัั ะฐะบััะฐะปัะฝัั ะธะฝัะพัะผะฐัะธั) ััะฐะฝะพะฒะธััั ะผะพะดะตะปั. ะะตะบะพะผะตะฝะดัะตะผัะต ะทะฝะฐัะตะฝะธั ะฝะฐัะพะดัััั ะฒ ะดะธะฐะฟะฐะทะพะฝะตย`0โ1000`ยะดะปั ะพะฑะพะธั.
- `gamma`ย(default=0, aka:ย`min_split_loss`) - ะทะฝะฐัะตะฝะธะต ะผะธะฝะธะผะฐะปัะฝะพะณะพ ะธะทะผะตะฝะตะฝะธั ะปะพััะฐ ะดะปั ัะฐะทะดะตะปะตะฝะธั ะฒะตัะฒะธ ะดะตัะตะฒะฐ - ัะตะผ ะฑะพะปััะตย`gamma`, ัะตะผ ะฑะพะปะตะต ะบะพะฝัะตัะฒะฐัะธะฒะฝะพะน ะฑัะดะตั ะผะพะดะตะปั.
- `min_child_weight`ย(default=1) - ะัะปะธ ัะฐะณ ัะฐะทะดะตะปะตะฝะธั ะดะตัะตะฒะฐ ะฟัะธะฒะพะดะธั ะบ ะปะธััะพะฒะพะผั ัะทะปั ั ััะผะผะพะน ะฒะตัะพะฒ ัะบะทะตะผะฟะปััะพะฒ ะผะตะฝััะต, ัะตะผย`min_child_weight`, ัะพ ะฟัะพัะตัั ะฟะพัััะพะตะฝะธั ะพัะบะฐะถะตััั ะพั ะดะฐะปัะฝะตะนัะตะณะพ ัะฐะทะดะตะปะตะฝะธั. ะงะตะผ ะฑะพะปััะตย`min_child_weight`, ัะตะผ ะฑะพะปะตะต ะบะพะฝัะตัะฒะฐัะธะฒะฝะพะน ะฑัะดะตั ะผะพะดะตะปั.
- `subsample`ย(default=1) - ะดะพะปั ัะบะทะตะผะฟะปััะพะฒ ะธะท ะพะฑััะฐััะตะน ะฒัะฑะพัะบะธ, ะบะพัะพัะฐั ะฑัะดะตั ะธัะฟะพะปัะทะพะฒะฐะฝะฐ ะดะปั ะฟะพัััะพะตะฝะธั ะดะตัะตะฒะฐ. 0.5 - ะฑะตัะตะผ ะฟะพะปะพะฒะธะฝั. ะะฑะฝะพะฒะปัะตััั ะฝะฐ ะบะฐะถะดะพะน ะธัะตัะฐัะธะธ.
- `colsample_bytree`,ย`colsample_bylevel`,ย`colsample_bynode`ย(default=1) - ัะตะผะตะนััะฒะพ ะฟะฐัะฐะผะตััะพะฒ ะฟะพ ะพััะตัะตะฝะธั ะดะพะปะธ ะฟัะธะทะฝะฐะบะพะฒ ะฝะฐ ะพะฟัะตะดะตะปะตะฝะฝะพะผ ััะพะฒะฝะต ะฟะพัััะพะตะฝะธั ะดะตัะตะฒะฐ.
- `max_bin`ย(default=256) - ะผะฐะบัะธะผะฐะปัะฝะพะต ัะธัะปะพ ะฑะธะฝะพะฒ, ะฝะฐ ะบะพัะพัะพะต ะผะพะถะตั ะฑััั ัะฐะทะฑะธั ัะธัะปะพะฒะพะน ะฟัะธะทะฝะฐะบ. ะฃะฒะตะปะธัะตะฝะธะต ะทะฝะฐัะตะฝะธั ััะพะณะพ ะฟะฐัะฐะผะตััะฐ ะผะพะถะตั ัะดะตะปะฐัั ะฑะธะฝะฐัะธะทะฐัะธั ะฑะพะปะตะต ะพะฟัะธะผะฐะปัะฝะพะน, ะฝะพ ัะฒะตะปะธัะธั ะฒัะตะผั ะพะฑััะตะฝะธั.
- `objective`ย(`default=reg:squarederror`) - ะปะพัั-ััะฝะบัะธั.ย**ะะฟัะตะดะตะปัะตั ะทะฐะดะฐัั, ะบะพัะพััั ะฒั ัะตัะฐะตัะต** , `reg:squaredlogerror`ย- ะบะฒะฐะดัะฐัะธัะฝะฐั ะพัะธะฑะบะฐ.
- `eval_metric` - ััะฝะบัะธั ะพัะตะฝะบะธ.

#### Optuna [Tuning]
- ะฅะพััย`Random Search`ยัะถะต ะทะฝะฐัะธัะตะปัะฝะพ ััะบะพััะตั ะฟัะพัะตัั ะฟะพะธัะบะฐ, ะผั ะผะพะถะตะผ ะฟัะพะฟัััะธัั ะฝะฐะฑะพั ะณะธะฟะตัะฟะฐัะฐะผะตััะพะฒ, ะฟัะธ ะบะพัะพัะพะผ ะผะพะดะตะปั ะฟะพะบะฐะทัะฒะฐะตั ะปัััะตะต ะบะฐัะตััะฒะพ.  
- ะ ััั, ะฒ ะณะพะปะพะฒั ะผะพะถะตั ะฟัะธะนัะธ ะธะดะตั: "ะ ััะพ, ะตัะปะธ ะฝะฐะผ ะฝะตะผะฝะพะณะพ ะฟะพัะณะฐะดัะฒะฐัั ะฒะฝะฐัะฐะปะต, ะบะฐะบ ะฒย`Random Search`. ะ ะฟะพัะพะผ ะฑัะดะตะผ ัะฐัะต ะฟัะพะฒะตัััั ะฒ ัะตั ะผะตััะฐั, ััะดะพะผ ั ะบะพัะพััะผะธ ะผะพะดะตะปั ะฟะพะบะฐะทะฐะปะฐ ะปััััั ัะพัะฝะพััั?!". ะขะฐะบะพะน ะผะตัะพะด ะฝะฐะทัะฒะฐะตััั -ย**ะะฐะนะตัะพะฒัะบะธะน ะฟะพะธัะบ ะณะธะฟะตัะฟะฐัะฐะผะตััะพะฒ ะผะพะดะตะปะธ**.
- ะกะฐะผัะต ะฟะพะฟัะปััะฝัะต ะฑะธะฑะปะธะพัะตะบะธ, ะฒ ะบะพัะพััั ัะตะฐะปะธะทะพะฒะฐะฝ ััะพั ะผะตัะพะด -ย`HyperOpt`ยะธย`Optuna`. (ะฒ ะฝะฐัะตะน ะฟัะฐะบัะธะบะต cย`HyperOpt`ยัะฐััะพ ัะปััะฐัััั ัะฑะพะธ ะธ ะฝะตััะฐะฑะธะปัะฝะฐั ัะฐะฑะพัะฐ, ะฟะพััะพะผั ะฒ ััะพะผ ะฝะพััะฑัะบะต ัะพััะตะดะพัะพัะธะผัั ะฝะฐย**`Optuna`**)
##### ะะปััะตะฒัะต ะพัะพะฑะตะฝะฝะพััะธ Optuna
- ๐ฏ ะะตะณะบะพะฒะตัะฝะพััั ะธ ัะฝะธะฒะตััะฐะปัะฝะพััั - ะผะพะถะฝะพ ะฟะพะดะฑะธัะฐัั ะพะฟัะธะผะฐะปัะฝัะต ะฟะฐัะฐะผะตััั ะฟะพะด ะปัะฑัะต ััะฝะบัะธะธ ะธ ะผะตััะธะบะธ
- ๐ SOTA ะฐะปะณะพัะธัะผั, ะฐะดะฐะฟัะธัะพะฒะฐะฝะฝัะต ะดะปั ะฟะพะธัะบะฐ ะณะธะฟะตัะฟะฐัะฐะผะตััะพะฒ
- โฑ ะะฐัะฐะปะปะตะปะธะทะฐัะธั ะธ ัะฐะทะปะธัะฝัะต ะผะตัะพะดั ะฟััะฝะธะฝะณะฐ
- ๐ ะัััะพะตะฝะฝะฐั ะฒะธะทัะฐะปะธะทะฐัะธั
- ๐ค ะะฝัะตะณัะฐัะธั ัะพ ะผะฝะพะถะตััะฒะพะผ ะฟะพะฟัะปััะฝัั ะฑะธะฑะปะธะพัะตะบ (ะฑัััะธะฝะณะธ,ย**sklearn**,ย**PyTorch**,ย**W&B**ยะธ ะดััะณะธะต)
##### Cััะฝะพััะธ Optuna
ะ `optuna` ะฟัะธัััััะฒััั ะดะฒะต ะฑะฐะทะพะฒัะต ัััะฝะพััะธ - `study` ะธ `trial`.
ะ ะฟะตัะฒะพะน ะฝะฐัะพะดะธััั ะบะพะด ะฟะพะดััะตัะฐ ะผะตััะธะบะธ, ะฒะพ ะฒัะพัะพะน ะฟะฐัะฐะผะตััั ะดะปั ะฟะตัะตะฑะพัะฐ. ะ ะฟัะธะผะตัั:
```python

param = trial.suggest_float('param', 0, 1.5)ย

loss_function = trial.suggest_categorical('loss', ['Logloss', 'CrossEntropy'])

depth = trial.suggest_int('depth', 5, 8)

learning_rate = trial.suggest_uniform('learning_rate', 0.0, 1.0)
```

**Study parameters**
ะะฝะธัะธะฐะปะธะทะธััะตะผ ะพะฑัะตะบัย`study`, ะบะพัะพััะน ะฝะฐัะฝะตั ะฟะตัะตะฑะพั ะธ ัะพััะฐะฝะธั ะฒ ัะตะฑะต ะธััะพัะธั ัะตะทัะปััะฐัะพะฒ. ะัะปะธ ะผั ััะฐัะฐะตะผัั ัะฒะตะปะธัะธัั ะผะตััะธะบั, ะฐ ะฝะต ัะผะตะฝััะธัั ะพัะธะฑะบั, ัะพ ะธัะฟะพะปัะทัะตะผย`create_study(direction='maximize')`

```
study = optuna.create_study()
study.optimize(objective, n_trials=10)
```
ะย[`Optuna`](https://optuna.readthedocs.io/en/stable/index.html)ยัะตะฐะปะธะทะพะฒะฐะฝะพ ะฝะตัะบะพะปัะบะพ ะผะตัะพะดะพะฒ (`sampler`) ะฟะพะดะฑะพัะฐ ะฟะฐัะฐะผะตััะพะฒ (ะฒ ัะพะผ ัะธัะปะต ะบะปะฐััะธัะตัะบะธะต):
- `GridSampler`
- `RandomSampler`
- `Tree-Structed Parzen Estimator`ย(`TPESampler`ย- ัะฐะผัะน ะฟะพะฟัะปััะฝัะน - ะดะตัะพะปัะฝัะน)
- `BruteForceSampler`
- ะ ะตััย[4 ะดััะณะธั](https://optuna.readthedocs.io/en/stable/reference/samplers/index.html#module-optuna.samplers), ัะฐะบะถะต ะผะพะถะฝะพ ะฝะฐะฟะธัะฐัั ัะพะฑััะฒะตะฝะฝัะน ััะผะฟะปะตั.
**ะัะธะผะตั**
```
# ะะณัะฐะฝะธัะธะผ ะปะพะณะธัะพะฒะฐะฝะธะต
optuna.logging.set_verbosity(30)

def objective(trial):
    x = trial.suggest_float("x", -8, 10)
    return (x + 1) * (x + 5) * (x - 9)

# ัะพะทะดะฐะดะธะผ ะพะฑัะตะบั ะพะฑััะตะฝะธั, ะธ ะทะฐะฟัััะธะผ ะฝะฐ 10 ะธัะตัะฐัะธะน; ั.ะบ ะผั ะธัะตะผ ะผะธะฝะธะผัะผ, ะฟะฐัะฐะผะตัั direction ะพััะฐะฒะปัะตะผ ะดะตัะพะปัะฝัะผ
study = optuna.create_study()

# ะทะฐะฟััะบ ะฟะพะธัะบะฐ
study.optimize(objective,
               n_jobs=-1,
               n_trials=250,
               show_progress_bar=True)
```

##### ะกะพะฒะตัั ะฟะพ ะฟะตัะตะฑะพัั ะฟะฐัะฐะผะตััะพะฒ (ะพัะตะฝั ะปะพะณะธัะฝัะต)
- ะะผะตัั ะฟะพะฝะธะผะฐะฝะธะต ะฒะฐะถะฝะพััะธ ะฟะฐัะฐะผะตััะพะฒ
- ะงะธัะปะพย`iterations`ยะปัััะต ะฒะทััั ั ะทะฐะฟะฐัะพะผ ะธ ะทะฐัะธะบัะธัะพะฒะฐัั, ะฟัะธ ััะพะผ ะพะณัะฐะฝะธัะธะฒ ัะตัะตะทย`early_stopping_rounds`
- ะะพะดัะผะพััะตัั/ััะฒััะฒะพะฒะฐัั ะดะธะฐะฟะฐะทะพะฝั ะธ ัะฐะณ ะทะฝะฐัะตะฝะธะน
- ะัะบะปััะธัั ัะพ, ััะพ ะฟะตัะตะฑะธัะฐัั ะฝะต ะฝัะถะฝะพ. (`random_seed`ย,ย`eval_metric`,ย`thread_count`ยะธ ะฟัะพัะตะต)
- ะัะฟะพะปัะทัะนัะต ะธะฝัะพัะผะฐัะธั ั ะฟัะพัะปัั ะฟะพะฟััะพะบ
###### fit catboost
```
def fit_catboost(trial, train, val):
    X_train, y_train = train
    X_val, y_val = val
    param = {
        'iterations' : 400, # ะะพะถะฝะพ ะฝะต ะฟะตัะตะฑะธัะฐัั, ะตััั Early-Stopping
        "learning_rate": trial.suggest_float("learning_rate", 0.001, 0.01),
        "l2_leaf_reg": trial.suggest_int("l2_leaf_reg", 2, 50),
        "colsample_bylevel": trial.suggest_float("colsample_bylevel", 0.01, 0.8),   
        "auto_class_weights": trial.suggest_categorical("auto_class_weights", ["SqrtBalanced", "Balanced", "None"]),
        "depth": trial.suggest_int("depth", 3, 9),
        "boosting_type": trial.suggest_categorical("boosting_type", ["Ordered", "Plain"]),
        "bootstrap_type": trial.suggest_categorical("bootstrap_type", ["Bayesian", "Bernoulli", "MVS"]),
        "used_ram_limit": "14gb",
        "eval_metric": "Accuracy", # ะขะพะถะต ััะพะธั ะทะฐัะฐะฝะตะต ะพะฟัะตะดะตะปะธัััั
    }

    
    if param["bootstrap_type"] == "Bayesian":
        param["bagging_temperature"] = trial.suggest_float("bagging_temperature", 0, 20)
        
    elif param["bootstrap_type"] == "Bernoulli":
        param["subsample"] = trial.suggest_float("subsample", 0.1, 1)
    clf = CatBoostClassifier(
        **param,
        thread_count=-1,
        random_seed=42,
        cat_features=cat_features,
    )
    clf.fit(
        X_train,
        y_train,
        eval_set=(X_val, y_val),
        verbose=0,
        plot=False,
        early_stopping_rounds=5,
    )

    y_pred = clf.predict(X_val)
    return clf, y_pred
```
###### objective function
```
def objective(trial, return_models=False):
    n_splits = 3
    kf = KFold(n_splits=n_splits, shuffle=True, random_state=42)
    X_train = train[filtered_features].drop(targets, axis=1, errors="ignore")
    y_train = train["target_class"]
    scores, models = [], []
    for train_idx, valid_idx in kf.split(X_train):
        train_data = X_train.iloc[train_idx, :], y_train.iloc[train_idx]
        valid_data = X_train.iloc[valid_idx, :], y_train.iloc[valid_idx]
        # ะะพะดะฐะตะผ trials ะดะปั ะฟะตัะตะฑะพัะฐ
        model, y_pred = fit_catboost(trial, train_data, valid_data) # ะะฟัะตะดะตะปะธะปะธ ะฒััะต
        scores.append(accuracy_score(y_pred, valid_data[1]))
        models.append(model)
        breal     
    result = np.mean(scores)
    if return_models:
        return result, models
    else:
        return result
```
###### ะะฐะฟััะบะฐะตะผ ะพะฑััะตะฝะธะต
```
study = optuna.create_study(direction="maximize")
study.optimize(objective,
               n_trials=600,
               n_jobs = -1,
               show_progress_bar=True,)
print("Best trial: score {}, params {}".format(study.best_trial.value, study.best_trial.params))
```
ะะฑััะธะผ ะธัะพะณะพะฒัั ะผะพะดะตะปั ะฝะฐ ะปัััะธั ะฟะฐัะฐะผะตััะฐั:
```
valid_scores, models = objective(
    optuna.trial.FixedTrial(study.best_params),
    return_models=True,
)
```

###### ะะธะทัะฐะปะธะทะฐัะธั
```
trials_df = study.trials_dataframe().sort_values('value', ascending=False)
trials_df.head(3)

# ะััะพัะธั ะธะทะผะตะฝะตะฝะธั ะพั ัะธัะปะฐ ะธัะฟััะฐะฝะธะน
optuna.visualization.plot_optimization_history(study)

# ะะฐะฒะธัะธะผะพััั ะฒ ัะฐะทัะตัะต ะฟะพ ะฟะฐัะฐะผะตััะฐะผ
params = ['l2_leaf_reg', 'colsample_bylevel', 'bagging_temperature', 'depth', 'bootstrap_type', 'subsample']
optuna.visualization.plot_slice(study,
                                params=params,
                                target_name = 'accuracy_score')
# ะะฐะถะฝะพััั ะฟะฐัะฐะผะตััะพะฒ
optuna.visualization.plot_param_importances(study)
```
###### Pruning
ะะตะฐะปะธะทะฐัะธะธ ะฟััะฝะตัะพะฒ ะตััั ะดะปั ะฑะพะปััะธะฝััะฒะฐ ะธะทะฒะตััะฝัั ML ััะตะนะผะฒะพัะบะพะฒ. ะะฐะฟัะธะผะตั,ย`callbacks`ยะดะปั ะฑัััะธะฝะณะพะฒ:

- `CatBoost`ย:ย`optuna.integration.CatBoostPruningCallback`
- `XGBoost`ย:ย`optuna.integration.XGBoostPruningCallback`
- `LightGBM`ย:ย`optuna.integration.LightGBMPruningCallback`

**ะัะฝะพะฒะฝัะต ะฒะธะดั ะฟััะฝะตัะพะฒ**:
- `Median Pruner`ย- ัะฐะผัะน ะฟะพะฟัะปััะฝัะน, ะบะฐะถะดัะต ะฝะตัะบะพะปัะบะพ ะธัะตัะฐัะธะน ะพัะฑัะฐััะฒะฐะตั ะฟะพะปะพะฒะธะฝั ะฟัะพัะตััะพะฒ ั ะฝะฐะธััะดัะธะผ ะบะฐัะตััะฒะพะผ
- `Successive Halving Algorithm`ย(SHA) - ัะฝะฐัะฐะปะฐ ะทะฐะฟััะบะฐััััย`trials`ยั ะผะธะฝะธะผะฐะปัะฝัะผะธ ัะตััััะฐะผะธ (ะผะฐะปะพ ะพะฑััะฐััะธั ะฟัะธะผะตัะพะฒ, ะผะฐะปะพ ะธัะตัะฐัะธะน), ะธ ะฝะฐ ะบะฐะถะดะพะผ ัะปะตะดัััะตะผ ัะฐะณะต ะพััะตะบะฐะตะผ ะฟะพะปะพะฒะธะฝัย`trials`ยั ััะดัะธะผ ะบะฐัะตััะฒะพะผ + ัะฒะตะปะธัะธะฒะฐะตะผ ัะตััััั
- `Percentile Pruner`,ย`Hyperband Pruner`ยะธย[ะดััะณะธะต](https://optuna.readthedocs.io/en/stable/reference/pruners.html)

```
ะะฝัััะธ objective_catboost

from optuna.integration import CatBoostPruningCallback
pruning_callback = CatBoostPruningCallback(trial, "Accuracy")

clf.fit(
        X_train,
        y_train,
        eval_set=(X_test, y_test),
        verbose=0,
        plot=False,
        early_stopping_rounds=5,
        callbacks=[pruning_callback],
    )  # ะะพะฑะฐะฒะปัะตะผ callback ะฒ fit

# ะทะฐะฟััะบะฐะตะผ ะฟัะพัะตัั ะฟััะฝะธะฝะณะฐ
pruning_callback.check_pruned()
```
###### ะัะธะผะตัะฐะฝะธะต
- ๐ ะฃย`Optuna`ยะตัั ะผะฝะพะถะตััะฒะพ ะฟะพะปะตะทะฝัั ะฟัะธะผะตะฝะตะฝะธะน, ะฒะฟะปะพัั ะดะพย[ะฟัะตะฟัะพัะตััะธะฝะณะฐ ะดะฐัะฐัะตัะพะฒ](https://t.me/ds_private_sharing/60), ะพะณัะฐะฝะธัะตะฝะธั ัะพะปัะบะพ ะฒ ะฒะฐัะตะน ัะฐะฝัะฐะทะธะธ.
- ๐ย[ะัะธัะธะฐะปัะฝัะต ัััะพัะธะฐะปั](https://optuna.readthedocs.io/en/stable/tutorial/index.html)ยั ะฟัะธะผะตัะฐะผะธ.